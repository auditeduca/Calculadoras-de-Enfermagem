<!DOCTYPE html>
<html lang="pt-br" class="scroll-smooth">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="description" content="Sistema profissional de calculadoras de enfermagem para segurança do paciente"/>
  
  <title>Calculadoras de Enfermagem | Cálculo Seguro de Medicamentos</title>
  
  <!-- Preconect para performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com"/>
  
  <!-- Fontes -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@700;800;900&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  
  <!-- Estilos Modulares -->
  <link rel="stylesheet" href="assets/css/variables-v4.css"/>
  <link rel="stylesheet" href="assets/css/header-v4.css"/>
  <link rel="stylesheet" href="assets/css/footer-v4.css"/>
  <link rel="stylesheet" href="assets/css/accessibility-v4.css"/>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Bibliotecas Externas (PDF) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

  <!-- Configuração Tailwind -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { 
            nunito: ['"Nunito Sans"','sans-serif'], 
            inter: ['Inter','sans-serif'] 
          },
          colors: { 
            'nurse-primary': '#1A3E74',
            'nurse-secondary': '#00bcd4',
            'nurse-accent': '#00838f',
            'nurse-bgDark': '#0F172A',
            'slate-50': '#f8fafc',
            'slate-100': '#f1f5f9',
            'slate-200': '#e2e8f0',
            'slate-300': '#cbd5e1',
            'slate-400': '#94a3b8',
            'slate-500': '#64748b',
            'slate-600': '#475569',
            'slate-700': '#334155',
            'slate-800': '#1e293b',
            'slate-900': '#0f172a'
          },
          animation: {
            'slide-in': 'slideIn 0.3s ease-out',
            'fade-in': 'fadeIn 0.3s ease-out',
          }
        }
      }
    }
  </script>

  <style type="text/tailwindcss">
    @layer base {
      body { 
        @apply bg-slate-50 text-slate-900 dark:bg-nurse-bgDark dark:text-slate-100 
               antialiased font-inter relative transition-colors duration-300; 
      }
      h1 { 
        @apply font-nunito font-black tracking-tight text-nurse-primary dark:text-cyan-400; 
      }
      h2, h3 { 
        @apply font-inter tracking-tight text-nurse-primary dark:text-cyan-400 font-extrabold; 
      }
    }
    
    @layer components {
      /* Componentes Base */
      .card-base { 
        @apply bg-white dark:bg-slate-800/90 rounded-[2rem] border border-slate-200 
               dark:border-slate-700 shadow-sm transition-all overflow-hidden; 
      }
      
      /* Botões */
      .btn-primary-action { 
        @apply bg-nurse-primary hover:bg-nurse-secondary text-white font-bold py-4 px-8 
               rounded-2xl shadow-xl transition-all active:scale-[0.98] flex items-center 
               justify-center gap-2 text-sm uppercase tracking-wider 
               disabled:opacity-50 disabled:cursor-not-allowed; 
      }
      
      .btn-secondary-action { 
        @apply bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 
               text-slate-600 dark:text-slate-200 font-bold py-4 rounded-2xl transition-all 
               flex items-center justify-center gap-2 text-sm uppercase tracking-wider; 
      }
      
      /* Inputs */
      .input-field { 
        @apply w-full bg-white dark:bg-slate-800 border-2 border-slate-200 
               dark:border-slate-700 rounded-xl px-4 py-3 focus:border-nurse-secondary 
               outline-none transition-all font-medium; 
      }
      
      /* Tabs */
      .tab-btn { 
        @apply flex-1 px-2 py-3 font-bold text-[10px] transition-all border-b-4 
               border-transparent text-slate-400 hover:text-nurse-primary 
               whitespace-nowrap text-center uppercase tracking-wider; 
      }
      
      .tab-btn.active { 
        @apply border-nurse-secondary text-nurse-primary dark:text-cyan-400 
               bg-slate-50/50 dark:bg-slate-900/30; 
      }
      
      /* Notificações */
      .toast-msg { 
        @apply pointer-events-auto bg-slate-900 text-white px-6 py-4 rounded-2xl 
               shadow-2xl flex items-center gap-4 font-bold text-sm min-w-[320px] 
               border-l-4 border-nurse-secondary animate-slide-in; 
      }
      
      /* Sidebar Tools */
      .sidebar-left-tools {
        position: fixed; 
        left: 0; 
        top: 50%; 
        transform: translateY(-50%);
        display: flex; 
        flex-direction: column; 
        gap: 12px; 
        z-index: 1000; 
        padding: 10px 0;
      }
      
      .tool-btn {
        background-color: white; 
        color: #1A3E74; 
        border: 1px solid #e2e8f0;
        border-left: none; 
        width: 54px; 
        height: 54px; 
        border-radius: 0 14px 14px 0;
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: center;
        cursor: pointer; 
        box-shadow: 4px 0 10px rgba(0, 0, 0, 0.05); 
        transition: all 0.3s;
        position: relative;
      }
    }
    
    /* Animações */
    @keyframes slideIn { 
      from { transform: translateX(100%); opacity: 0; } 
      to { transform: translateX(0); opacity: 1; } 
    }
    
    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(-10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    /* Responsividade Mobile para Sidebar */
    @media (max-width: 768px) {
      .sidebar-left-tools {
        top: auto; 
        bottom: 0; 
        left: 0; 
        width: 100%; 
        height: 70px;
        flex-direction: row; 
        transform: none; 
        justify-content: space-around;
        align-items: center; 
        background: white; 
        border-top: 1px solid #e2e8f0;
        border-radius: 0; 
        box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.08); 
        padding: 0 5px;
      }
      .tool-btn { 
        border: none; 
        width: auto; 
        height: auto; 
        gap: 4px; 
        box-shadow: none; 
        background: transparent; 
        border-radius: 0; 
      }
      body { padding-bottom: 80px; }
    }
  </style>
</head>
<body class="flex flex-col min-h-screen">

  <!-- Container de Acessibilidade -->
  <div id="accessibility-container"></div>
  
  <!-- Container de Notificações -->
  <div id="notification-container" class="fixed top-6 right-6 z-[10000] flex flex-col gap-3 pointer-events-none"></div>
  
  <!-- Header -->
  <div id="header-container" class="sticky top-0 z-50 bg-white dark:bg-nurse-bgDark shadow-sm"></div>

  <!-- Sidebar de Ferramentas -->
  <aside class="sidebar-left-tools" id="sidebar-tools">
    <button class="tool-btn" id="btn-conteudo" title="Conteúdo Técnico" aria-label="Abrir conteúdo técnico">
      <i class="fas fa-book-open"></i>
      <span class="btn-label">Conteúdo</span>
    </button>
    <button class="tool-btn" id="btn-nanda" title="Diagnósticos NANDA" aria-label="Abrir diagnósticos NANDA">
      <i class="fas fa-stethoscope"></i>
      <span class="btn-label">NANDA</span>
    </button>
    <button class="tool-btn" id="btn-9acertos" title="9 Acertos" aria-label="Abrir protocolo 9 acertos">
      <i class="fas fa-check-double"></i>
      <span class="btn-label">9 Acertos</span>
    </button>
    <button class="tool-btn" id="btn-metas" title="Metas de Segurança" aria-label="Abrir metas de segurança">
      <i class="fas fa-bullseye"></i>
      <span class="btn-label">Metas</span>
    </button>
  </aside>

  <!-- Conteúdo Principal -->
  <main id="main-content" class="flex-grow max-w-7xl mx-auto px-4 pt-8 pb-8 md:py-12 w-full" aria-label="Conteúdo principal">
    
    <!-- Breadcrumb -->
    <nav id="breadcrumb" class="mb-8 font-semibold" aria-label="Navegação estrutural">
      <div class="hidden md:flex items-center gap-2 text-sm text-slate-600 dark:text-cyan-300" id="breadcrumb-list">
        <!-- Carregado dinamicamente -->
      </div>
    </nav>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
      
      <!-- Coluna Principal (8 colunas) -->
      <div class="lg:col-span-8 space-y-8">
        
        <!-- Header da Calculadora -->
        <header class="space-y-4">
          <div class="flex items-center gap-3">
            <span id="calc-badge" class="px-4 py-1.5 bg-nurse-secondary/10 text-nurse-secondary text-[10px] font-black uppercase tracking-widest rounded-full border border-nurse-secondary/20">
              <!-- Badge dinâmico -->
            </span>
            <span id="calc-version" class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">
              <!-- Versão dinâmica -->
            </span>
          </div>
          <h1 id="calc-title" class="text-4xl md:text-5xl lg:text-6xl">
            <!-- Título dinâmico -->
          </h1>
          <p id="calc-description" class="text-lg text-slate-600 dark:text-slate-400 max-w-2xl leading-relaxed">
            <!-- Descrição dinâmica -->
          </p>
        </header>

        <!-- Card Principal -->
        <div class="card-base" role="region" aria-label="Área de cálculo">
          <!-- Tabs -->
          <div class="flex border-b border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/50 overflow-x-auto no-scrollbar" 
               id="tabs-container" role="tablist">
            <!-- Tabs dinâmicas -->
          </div>

          <!-- Conteúdo das Tabs -->
          <div class="p-6 md:p-10">
            
            <!-- Aba Calculadora -->
            <div id="pane-calc" class="tab-pane space-y-8" role="tabpanel" aria-labelledby="btn-tab-calc">
              <div id="calculator-fields" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Campos dinâmicos -->
              </div>

              <div class="flex flex-col sm:flex-row gap-4 pt-4" id="calc-buttons">
                <!-- Botões dinâmicos -->
              </div>

              <!-- Resultados -->
              <div id="results-wrapper" class="hidden mt-12 space-y-8 animate-fade-in">
                <!-- Resultado Principal -->
                <div class="bg-gradient-to-br from-nurse-primary to-nurse-accent rounded-[2.5rem] p-8 md:p-12 text-white shadow-2xl relative overflow-hidden">
                  <div class="relative z-10 text-center space-y-4">
                    <p class="text-xs font-black uppercase tracking-[0.3em] opacity-80">Volume Final a Aspirar</p>
                    <div class="flex items-baseline justify-center gap-2">
                      <span id="res-total" class="text-7xl md:text-9xl font-black tracking-tighter">0.00</span>
                      <span class="text-2xl md:text-4xl font-bold opacity-60">mL</span>
                    </div>
                  </div>
                </div>

                <!-- Auditoria -->
                <div class="space-y-6">
                  <h3 class="flex items-center gap-3 text-xl">
                    <i class="fa-solid fa-clipboard-check text-nurse-secondary"></i>
                    Auditoria do Cálculo
                  </h3>
                  <ul id="audit-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Itens de auditoria dinâmicos -->
                  </ul>
                </div>

                <!-- Checklists -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                  <div class="space-y-6">
                    <h3 class="text-lg">9 Certos da Medicação</h3>
                    <div id="checklist-9certos" class="grid grid-cols-1 gap-2">
                      <!-- Checklist 9 certos -->
                    </div>
                  </div>
                  <div class="space-y-6">
                    <h3 class="text-lg">Metas de Segurança</h3>
                    <div id="checklist-metas" class="flex flex-col gap-3">
                      <!-- Checklist metas -->
                    </div>
                  </div>
                </div>

                <!-- Ações de Resultado -->
                <div class="flex flex-wrap gap-4 pt-6" id="result-actions">
                  <!-- Ações dinâmicas -->
                </div>
              </div>
            </div>

            <!-- Aba Sobre -->
            <div id="pane-sobre" class="tab-pane hidden prose dark:prose-invert max-w-none" role="tabpanel" aria-labelledby="btn-tab-sobre">
              <div id="content-sobre"></div>
            </div>

            <!-- Aba Instruções -->
            <div id="pane-ajuda" class="tab-pane hidden prose dark:prose-invert max-w-none" role="tabpanel" aria-labelledby="btn-tab-ajuda">
              <div id="content-ajuda"></div>
            </div>

            <!-- Aba Referências -->
            <div id="pane-referencia" class="tab-pane hidden prose dark:prose-invert max-w-none" role="tabpanel" aria-labelledby="btn-tab-referencia">
              <div id="content-referencia"></div>
            </div>

          </div>
        </div>

        <!-- Seção Autor e Tags -->
        <footer class="pt-12 border-t border-slate-200 dark:border-slate-800 space-y-8">
          <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
            <div class="flex items-center gap-4">
              <img src="assets/images/author-info.webp" class="w-16 h-16 rounded-2xl shadow-lg" alt="Autor do sistema" loading="lazy"/>
              <div>
                <p class="text-xs font-black text-slate-400 uppercase tracking-widest">Publicado por</p>
                <p class="font-bold text-nurse-primary dark:text-cyan-400" id="calc-author">Calculadoras de Enfermagem</p>
              </div>
            </div>
            <div id="calc-tags" class="flex flex-wrap gap-2">
              <!-- Tags dinâmicas -->
            </div>
          </div>
        </footer>
      </div>

      <!-- Sidebar Direito (4 colunas) -->
      <aside class="lg:col-span-4 space-y-6" aria-label="Barra lateral de ferramentas">
        <div id="sidebar-right-content">
          <!-- Conteúdo dinâmico -->
        </div>
      </aside>

    </div>
  </main>

  <!-- Footer -->
  <div id="footer-container"></div>

  <!-- Modal de Referência -->
  <div id="reference-modal" class="fixed inset-0 z-[10000] hidden flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm" aria-hidden="true" role="dialog">
    <div class="bg-white dark:bg-slate-800 w-full max-w-2xl rounded-[2.5rem] shadow-2xl overflow-hidden animate-fade-in">
      <div class="p-8 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 bg-nurse-primary/10 rounded-2xl flex items-center justify-center">
            <i id="modal-icon" class="fa-solid fa-book text-nurse-primary dark:text-cyan-400 text-xl"></i>
          </div>
          <h2 id="modal-title" class="text-2xl">Título do Modal</h2>
        </div>
        <button onclick="CALCULATOR_SYSTEM.closeModal()" class="w-10 h-10 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors flex items-center justify-center" aria-label="Fechar modal">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div id="modal-content-area" class="p-8 max-h-[60vh] overflow-y-auto custom-scrollbar">
        <!-- Conteúdo dinâmico -->
      </div>
    </div>
  </div>

  <!-- Template para PDF (oculto) -->
  <div id="pdf-render-template" class="fixed -left-[9999px] top-0 bg-white w-[595px] p-10 font-inter text-slate-900">
    <div style="border-bottom: 2px solid #1A3E74; padding-bottom: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
      <div>
        <h1 style="margin: 0; font-size: 24px; color: #1A3E74;">RELATÓRIO DE AUDITORIA</h1>
        <p style="margin: 5px 0 0 0; font-size: 10px; font-weight: 800; color: #64748b; text-transform: uppercase;">Calculadoras de Enfermagem Profissional</p>
      </div>
      <div style="text-align: right;">
        <p id="pdf-date" style="margin: 0; font-size: 10px; font-weight: 700;"></p>
      </div>
    </div>
    <div id="pdf-body"></div>
    <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #e2e8f0; text-align: center; font-size: 8px; color: #94a3b8;">
      Este documento é um registro digital de conferência e deve ser anexado ao prontuário se aplicável.
    </div>
  </div>

  <!-- Scripts dos Módulos -->
  <script src="assets/js/util.js"></script>
  <script src="assets/js/notifications.js"></script>
  <script src="assets/js/ui.js"></script>
  <script src="assets/js/voice.js"></script>
  <script src="assets/js/calculator-engine.js"></script>
  <script src="assets/js/core.js"></script>
  <script src="assets/js/nursing_engine.js"></script>
  <script src="assets/js/main_content_injector.js"></script>
  <script src="assets/js/modal-reference.js"></script>
  <script src="assets/js/pdf-generator.js"></script>
  <script src="assets/js/nursing_calculators.js"></script>

  <!-- Sistema Principal -->
  <script>
    // Instância global do sistema
    window.CALCULATOR_SYSTEM = new NursingCalculators();
    
    // Inicialização quando o DOM estiver pronto
    document.addEventListener('DOMContentLoaded', () => {
      window.CALCULATOR_SYSTEM.initialize();
    });
    
    // Atribuir funções globais para botões
    window.switchTab = (tab) => {
      if (window.CALCULATOR_SYSTEM && window.CALCULATOR_SYSTEM.switchTab) {
        window.CALCULATOR_SYSTEM.switchTab(tab);
      }
    };
    
    window.calculate = () => {
      if (window.CALCULATOR_SYSTEM && window.CALCULATOR_SYSTEM.calculate) {
        window.CALCULATOR_SYSTEM.calculate();
      }
    };
    
    window.resetCalculator = () => {
      if (window.CALCULATOR_SYSTEM && window.CALCULATOR_SYSTEM.resetCalculator) {
        window.CALCULATOR_SYSTEM.resetCalculator();
      }
    };
    
    window.share = (platform) => {
      if (window.CALCULATOR_SYSTEM && window.CALCULATOR_SYSTEM.share) {
        window.CALCULATOR_SYSTEM.share(platform);
      }
    };
    
    // Prevenir valores negativos nos inputs
    window.preventNegative = (event) => {
      if (event.key === '-') {
        event.preventDefault();
        return false;
      }
    };
  </script>
</body>
</html>