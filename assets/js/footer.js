(function(){"use strict";const e={banner:null,overlay:null,modal:null,backToTop:null,cookieFab:null,yearSpan:null,toast:null,toastMessage:null,scrollTimeout:null,detailModals:{},accordionBtns:{}},T="ce_cookie_consent_v8_2025";let f=null,s=[],y=[];function k(){e.banner=document.getElementById("cookie-banner"),e.overlay=document.getElementById("cookie-overlay"),e.modal=document.getElementById("cookie-modal-content"),e.backToTop=document.getElementById("backToTop"),e.cookieFab=document.getElementById("cookie-fab"),e.yearSpan=document.getElementById("current-year"),e.toast=document.getElementById("toast-notification"),e.toastMessage=document.getElementById("toast-message"),e.modal&&!e.modal.classList.contains("hidden")&&(e.modal.classList.add("hidden"),e.modal.setAttribute("aria-hidden","true")),e.overlay&&!e.overlay.classList.contains("hidden")&&(e.overlay.classList.add("hidden"),e.overlay.setAttribute("aria-hidden","true")),e.cookieFab&&e.cookieFab.classList.add("hidden"),document.querySelectorAll(".cookie-detail-modal").forEach(function(n){n.id&&(e.detailModals[n.id]=n,n.classList.contains("hidden")||(n.classList.add("hidden"),n.setAttribute("aria-hidden","true")))}),document.querySelectorAll(".cookie-expand-btn").forEach(function(n){const c=n.getAttribute("data-accordion-target");c&&(e.accordionBtns[c]=n)}),e.yearSpan&&(e.yearSpan.textContent=new Date().getFullYear()),F(),q(),O(),D()}function C(t){!e.toast||!e.toastMessage||(e.toastMessage.textContent=t,e.toast.classList.remove("hidden"),e.toast.offsetWidth,e.toast.classList.add("visible"),setTimeout(function(){e.toast.classList.remove("visible"),setTimeout(function(){e.toast.classList.add("hidden")},300)},3e3))}function F(){const t=localStorage.getItem(T);if(t)try{const i=JSON.parse(t);B(i)?(I(i),m()):b()}catch{b()}else b()}function B(t){return!(!["consented","timestamp","necessary","analytics","marketing","version"].every(function(c){return Object.prototype.hasOwnProperty.call(t,c)})||typeof t.consented!="boolean"||typeof t.necessary!="boolean"||typeof t.analytics!="boolean"||typeof t.marketing!="boolean"||isNaN(Date.parse(t.timestamp)))}function b(){e.banner&&(e.banner.classList.add("visible"),e.banner.style.display="flex"),g(!0),e.cookieFab&&e.cookieFab.classList.add("hidden")}function m(){e.banner&&(e.banner.classList.remove("visible"),setTimeout(function(){e.banner.style.display="none",g(!1)},300)),e.cookieFab&&e.cookieFab.classList.remove("hidden")}function g(t){e.backToTop&&(e.backToTop.style.bottom=t?"130px":"30px"),e.cookieFab&&!e.cookieFab.classList.contains("hidden")&&(e.cookieFab.style.bottom=t?"180px":"80px"),e.toast&&(e.toast.style.bottom=t?"200px":"7rem")}function A(){if(f=document.activeElement,e.modal&&!e.modal.classList.contains("hidden")&&s.push(e.modal),e.overlay&&(e.overlay.classList.remove("hidden"),e.overlay.setAttribute("aria-hidden","false")),e.modal){e.modal.classList.remove("hidden"),e.modal.setAttribute("aria-hidden","false"),_(),v(e.modal);const t=e.modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');t&&setTimeout(function(){t.focus()},100)}x(e.modal)}function p(){if(s.length>0){const t=s.pop();t&&(t.classList.add("hidden"),t.setAttribute("aria-hidden","true"),t===e.modal&&m())}h()}function M(t){const i=e.detailModals[t];if(!i)return;e.modal&&!e.modal.classList.contains("hidden")&&s.push(e.modal),e.overlay&&(e.overlay.classList.remove("hidden"),e.overlay.setAttribute("aria-hidden","false")),i.classList.remove("hidden"),i.setAttribute("aria-hidden","false"),v(i);const n=i.querySelector(".cookie-modal-close");n&&setTimeout(function(){n.focus()},100),x(i)}function w(t){const i=e.detailModals[t];if(i){if(i.classList.add("hidden"),i.setAttribute("aria-hidden","true"),s.length>0){const n=s.pop();n&&(n.classList.remove("hidden"),n.setAttribute("aria-hidden","false"),f&&setTimeout(function(){f.focus()},100))}h()}}function h(){s.length===0?(e.overlay&&(e.overlay.classList.add("hidden"),e.overlay.setAttribute("aria-hidden","true")),f&&f.focus()):e.overlay&&(e.overlay.classList.remove("hidden"),e.overlay.setAttribute("aria-hidden","false"))}function v(t){t&&(y=Array.from(t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(function(i){return i.offsetParent!==null&&!i.disabled}))}function x(t){t&&t.addEventListener("keydown",function(n){if(n.key!=="Tab"||(v(t),y.length===0))return;const c=y[0],l=y[y.length-1];n.shiftKey?document.activeElement===c&&(n.preventDefault(),l.focus()):document.activeElement===l&&(n.preventDefault(),c.focus())})}function E(t){const i=document.getElementById(t),n=e.accordionBtns[t];if(!i)return;i.classList.contains("expanded")?(i.classList.remove("expanded"),n&&(n.classList.remove("expanded"),n.setAttribute("aria-expanded","false"))):(S(),i.classList.add("expanded"),n&&(n.classList.add("expanded"),n.setAttribute("aria-expanded","true")),setTimeout(function(){const l=i.querySelector("p");l&&l.focus()},300))}function S(){document.querySelectorAll(".cookie-category-description").forEach(function(t){t.classList.remove("expanded")}),document.querySelectorAll(".cookie-expand-btn").forEach(function(t){t.classList.remove("expanded"),t.setAttribute("aria-expanded","false")})}function _(){S()}function L(t){if(typeof t!="boolean"&&t!=="partial")return;const i=document.getElementById("check-necessary"),n=document.getElementById("check-analytics"),c=document.getElementById("check-marketing"),u={consented:t===!0||t==="partial",timestamp:new Date().toISOString(),necessary:i?i.checked:!0,analytics:n?n.checked:t===!0,marketing:c?c.checked:t===!0,version:"8.0"};if(B(u)){try{localStorage.setItem(T,JSON.stringify(u)),I(u),window.dispatchEvent(new CustomEvent("consentUpdated",{detail:u})),C(t===!0?"Cookies aceitos com sucesso!":"Prefer\xEAncias salvas!")}catch{}m(),p()}}function I(t){typeof window.applyConsentSettings=="function"&&window.applyConsentSettings(t),typeof gtag<"u"&&gtag("consent","update",{analytics_storage:t.analytics?"granted":"denied",ad_storage:t.marketing?"granted":"denied",ad_user_data:t.marketing?"granted":"denied",ad_personalization:t.marketing?"granted":"denied"}),window.dataLayer&&(window.dataLayer.push({event:"consent_update",consent_analytics:t.analytics?"granted":"denied",consent_marketing:t.marketing?"granted":"denied",consent_necessary:"granted"}),window.dataLayer.push({event:"privacy_consent",consent_analytics:t.analytics,consent_marketing:t.marketing,consent_necessary:!0}))}function q(){if(!e.backToTop)return;const t=function(){window.scrollY>300?(e.backToTop.classList.add("visible"),e.backToTop.classList.remove("hidden")):(e.backToTop.classList.remove("visible"),e.backToTop.classList.add("hidden"))};window.addEventListener("scroll",function(){clearTimeout(e.scrollTimeout),e.scrollTimeout=setTimeout(t,100)}),t(),e.backToTop.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}function O(){const t=e.banner&&e.banner.classList.contains("visible");g(t)}function D(){const t=document.getElementById("cookie-accept"),i=document.getElementById("cookie-settings"),n=document.getElementById("cookie-fab"),c=document.getElementById("cookie-modal-close"),l=document.getElementById("cookie-save-preferences"),u=document.getElementById("cookie-accept-all");t&&t.addEventListener("click",function(){const a=document.getElementById("check-analytics"),o=document.getElementById("check-marketing");a&&(a.checked=!0),o&&(o.checked=!0),L(!0)}),i&&i.addEventListener("click",function(){A()}),n&&n.addEventListener("click",A),c&&c.addEventListener("click",function(){p()}),l&&l.addEventListener("click",function(){L("partial")}),u&&u.addEventListener("click",function(){const a=document.getElementById("check-analytics"),o=document.getElementById("check-marketing");a&&(a.checked=!0),o&&(o.checked=!0),L(!0)}),document.addEventListener("click",function(a){if(a.target.closest(".cookie-expand-btn")){const o=a.target.closest(".cookie-expand-btn");a.stopPropagation();const d=o.getAttribute("data-accordion-target");d&&E(d);return}if(a.target.closest(".cookie-category-header")){const d=a.target.closest(".cookie-category-header").nextElementSibling;if(d&&d.classList.contains("cookie-category-description")){const r=d.id;r&&E(r)}}}),document.addEventListener("keydown",function(a){if(a.target.closest(".cookie-category-header")&&(a.key==="Enter"||a.key===" ")){a.preventDefault();const d=a.target.closest(".cookie-category-header").nextElementSibling;if(d&&d.classList.contains("cookie-category-description")){const r=d.id;r&&E(r)}}}),document.querySelectorAll(".cookie-info-btn").forEach(function(a){a.addEventListener("click",function(){const o=this.getAttribute("data-modal-target");o&&(f=this,M(o))})}),document.querySelectorAll(".cookie-detail-modal .cookie-modal-close").forEach(function(a){a.addEventListener("click",function(){const o=this.closest(".cookie-detail-modal");o&&o.id&&w(o.id)})}),document.querySelectorAll(".cookie-detail-back").forEach(function(a){a.addEventListener("click",function(){const o=this.getAttribute("data-close");o&&w(o)})}),e.overlay&&e.overlay.addEventListener("click",function(a){if(a.target===e.overlay){if(s.length>0){const o=s[s.length-1];o&&(o===e.modal?(p(),m()):(o.classList.add("hidden"),o.setAttribute("aria-hidden","true"),s.pop()))}h()}}),document.addEventListener("keydown",function(a){if(a.key==="Escape"&&s.length>0){const o=s[s.length-1];o&&(o.classList.add("hidden"),o.setAttribute("aria-hidden","true"),s.pop()),h(),s.length===0&&m()}}),document.querySelectorAll(".cookie-modal, .cookie-detail-modal").forEach(function(a){a.addEventListener("click",function(o){o.stopPropagation()})}),document.querySelectorAll("[data-close]").forEach(function(a){a.addEventListener("click",function(){const o=this.getAttribute("data-close"),d=document.getElementById(o);if(d){d.classList.add("hidden"),d.setAttribute("aria-hidden","true");const r=s.indexOf(d);r>-1&&s.splice(r,1),h(),s.length===0&&m()}})}),document.querySelectorAll('.cookie-switch input[type="checkbox"]').forEach(function(a){a.addEventListener("change",function(){const o=this.nextElementSibling;o&&(o.style.backgroundColor=this.checked?"#2563eb":"#e5e7eb")})})}function P(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){setTimeout(k,50)}):setTimeout(k,50)}P(),window.addEventListener("TemplateEngine:Ready",function(){setTimeout(k,100)})})();
